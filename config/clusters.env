# 集群与入口端口配置（可调整）
# 基于域名路由的基础域名，最终域名为 <env>.<BASE_DOMAIN>
#
# 方案 1: 使用 sslip.io (零配置，推荐默认)
#   BASE_DOMAIN=192.168.51.30.sslip.io
#   访问示例: dev.192.168.51.30.sslip.io
#
# 方案 2: 使用本地域名 (需配置 /etc/hosts 或运行 scripts/update_hosts.sh)
#   BASE_DOMAIN=local
#   访问示例: dev.local
#
# 方案 3: 使用 curl -H 'Host: xxx' 方式 (测试用)
BASE_DOMAIN=192.168.51.30.sslip.io

# HAProxy 对外访问的主机名或 IP（用于 Portainer HTTP→HTTPS 重定向）
# 示例：HAPROXY_HOST=192.168.51.30 或 HAPROXY_HOST=gw.local
HAPROXY_HOST=192.168.51.30

# provider: k3d | kind
PROVIDER_DEV=kind
PROVIDER_UAT=kind
PROVIDER_PROD=kind
PROVIDER_OPS=kind

# cluster names
CLUSTER_DEV=dev
CLUSTER_UAT=uat
CLUSTER_PROD=prod
CLUSTER_OPS=ops

# host ports mapping for each env
DEV_HTTP=18090
DEV_HTTPS=18443
UAT_HTTP=28080
UAT_HTTPS=28443
PROD_HTTP=38080
PROD_HTTPS=38443
OPS_HTTP=48080
OPS_HTTPS=48443

# Kubernetes 版本镜像（可按需调整）
# kind 节点镜像（默认 v1.31.12）
KIND_NODE_IMAGE=kindest/node:v1.31.12
# k3d 使用的 k3s 镜像（默认稳定版）
K3D_IMAGE=rancher/k3s:v1.31.5-k3s1
# Default node resources (docker container limits)
DEFAULT_NODE_CPUS=4
DEFAULT_NODE_MEMORY=8g

# 基础设施软件版本
# Portainer CE 版本
PORTAINER_VERSION=2.33.2-alpine
# ArgoCD 版本
ARGOCD_VERSION=v3.1.8
# HAProxy 版本
HAPROXY_VERSION=3.2.6-alpine3.22
# 基础服务端口配置（可根据环境需求调整）
# Portainer 端口
PORTAINER_HTTP_PORT=9000
PORTAINER_HTTPS_PORT=9443
# ArgoCD 端口
ARGOCD_NODEPORT=30800
ARGOCD_SERVICE_PORT=80
# HAProxy 统一入口端口（域名隔离，默认使用 80/443，可按需覆盖）
HAPROXY_HTTP_PORT=80
HAPROXY_HTTPS_PORT=443

# ================================================================================
# 核心服务固定 IP 配置（管理网络）
# ================================================================================
# 管理网络用于核心服务的固定 IP 分配
# - 子网: 10.100.255.0/24
# - 网关: 10.100.255.1
# - HAProxy 和 Portainer 在此网络中有固定 IP（仅内部使用）
#
MANAGEMENT_SUBNET=10.100.255.0/24
MANAGEMENT_GATEWAY=10.100.255.1

# HAProxy 固定 IP（management 网络内部）
# - 用于 HAProxy 内部通信和后端配置
# - 集群**不直接**访问此 IP
HAPROXY_FIXED_IP=10.100.255.100

# Portainer 固定 IP（management 网络内部）
# - HAProxy 通过此 IP 转发请求到 Portainer
# - 集群**不直接**访问此 IP
PORTAINER_FIXED_IP=10.100.255.101

# ================================================================================
# 宿主机统一入口（集群访问核心服务）
# ================================================================================
# 所有集群通过宿主机 IP 访问核心服务（HAProxy、Portainer 等）
# - Edge Agent URL: http://${HAPROXY_HOST}:${HAPROXY_HTTP_PORT}
# - 优势：业务集群完全隔离，统一入口，配置简单
#
HAPROXY_HOST=192.168.51.30

# ================================================================================
# 网络架构说明（方案 C: 混合方案）
# ================================================================================
# 1. 管理网络 (management): 10.100.255.0/24
#    - HAProxy: 10.100.255.100 (仅内部使用)
#    - Portainer: 10.100.255.101 (仅内部使用)
#    - 预留: 10.100.255.102-254 (未来服务)
#
# 2. k3d 集群网络（独立子网，完全隔离）:
#    - devops: 10.100.10.0/24 (管理集群)
#    - dev-k3d: 10.100.50.0/24 (业务集群)
#    - uat-k3d: 10.100.60.0/24 (业务集群)
#    - prod-k3d: 10.100.70.0/24 (业务集群)
#    - 其他集群: 10.100.80-250.x (避开 255 段)
#
# 3. kind 集群网络:
#    - 使用 Docker 默认 bridge 网络（不支持自定义子网）
#
# 4. 网络连接拓扑:
#    - HAProxy: management + infrastructure + k3d-devops（仅连接管理集群）
#    - Portainer: management + infrastructure（不连接业务集群）
#    - 业务集群: 独立子网（彼此隔离，无直接连接）
#
# 5. 统一入口（宿主机 IP）:
#    - 所有集群通过宿主机 IP (192.168.51.30) 访问核心服务
#    - HAProxy 暴露端口: 80/443/8000 -> 宿主机 192.168.51.30
#    - Edge Agent URL: http://192.168.51.30:80
#    - 优势: 业务集群完全隔离，配置简单，性能优异
#
# 6. HAProxy 后端路由:
#    - Portainer: 10.100.255.101:9000 (management 网络)
#    - devops 集群: 10.100.10.2:30800 (k3d-devops 网络)
#    - 业务集群: 通过宿主机端口访问（不需要 HAProxy 直连）
#

# ================================================================================
# k3d 集群子网配置
# ================================================================================
# 注意：子网配置在 config/environments.csv 的 cluster_subnet 列中定义
# - 如果指定子网：创建独立网络（k3d-<cluster-name>），使用指定子网
# - 如果未指定（留空）：使用共享网络（k3d-shared），Docker 自动分配 IP
# - kind 集群不支持自定义子网，cluster_subnet 列应留空
